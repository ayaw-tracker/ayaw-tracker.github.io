DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Are You Actually Winning?</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
        }
        .container {
            max-width: 1024px;
            margin: 2rem auto;
            padding: 1.5rem;
            background-color: #ffffff;
            border-radius: 0.75rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        /* Hide default number input spinners */
        input[type="number"]::-webkit-inner-spin-button,
        input[type="number"]::-webkit-outer-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        input[type="number"] {
            -moz-appearance: textfield;
        }
        /* Style for the individual player prop rows */
        .player-prop-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)) auto;
            gap: 0.75rem;
            padding: 0.75rem;
            background-color: #f9fafb;
            border-radius: 0.5rem;
            border: 1px solid #e5e7eb;
            align-items: center;
            transition: all 0.3s ease;
            opacity: 0;
            transform: translateY(-10px);
            animation: slideIn 0.3s ease forwards;
        }

        @keyframes slideIn {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .player-prop-row.removing {
            animation: slideOut 0.3s ease forwards;
        }

        @keyframes slideOut {
            to {
                opacity: 0;
                transform: translateX(-100%);
            }
        }

        /* Modal specific styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.6);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            transition: opacity 0.3s ease-in-out;
            opacity: 0;
            visibility: hidden;
        }
        .modal-overlay.show {
            opacity: 1;
            visibility: visible;
        }
        .modal-content {
            background-color: #ffffff;
            padding: 2rem;
            border-radius: 0.75rem;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
            max-width: 500px;
            width: 90%;
            text-align: center;
            transform: translateY(-20px);
            transition: transform 0.3s ease-in-out;
        }
        .modal-overlay.show .modal-content {
            transform: translateY(0);
        }

        /* Success message animation */
        .success-message {
            transform: translateY(-100%);
            transition: all 0.5s ease;
        }

        .success-message.show {
            transform: translateY(0);
        }

        /* Improved input focus states */
        .form-input:focus {
            ring-color: #3b82f6;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        /* Hover effects for buttons */
        .btn-primary {
            transition: all 0.2s ease;
        }

        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
        }

        /* Loading spinner */
        .spinner {
            border: 2px solid #f3f4f6;
            border-top: 2px solid #3b82f6;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-gray-100 p-4 sm:p-6 md:p-8">
    <div class="container">
        <header class="text-center mb-8">
            <h1 class="text-3xl sm:text-4xl font-bold text-gray-800 mb-2">Are You Actually Winning?</h1>
            <p class="text-gray-600">Track your parlay betting performance honestly</p>
        </header>

        <section class="bg-white p-6 rounded-lg shadow-sm mb-8">
            <h2 class="text-2xl font-semibold text-gray-700 mb-4">Add New Parlay</h2>
            <form id="parlayForm" class="space-y-6">
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
                    <div>
                        <label for="result" class="block text-sm font-medium text-gray-700 mb-1">Parlay Result</label>
                        <select id="result" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                            <option value="Win">Win</option>
                            <option value="Loss">Loss</option>
                            <option value="Push">Push</option>
                        </select>
                    </div>
                    
                    <div>
                        <label for="playType" class="block text-sm font-medium text-gray-700 mb-1">Payout Type</label>
                        <select id="playType" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                            <option value="Power">Power Play</option>
                            <option value="Flex">Flex Play</option>
                        </select>
                    </div>
                    
                    <div>
                        <label for="amountWagered" class="block text-sm font-medium text-gray-700 mb-1">Amount Wagered ($)</label>
                        <input type="number" 
                               id="amountWagered" 
                               step="0.01" 
                               min="0" 
                               placeholder="0.00" 
                               class="money-input w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500" 
                               required>
                    </div>
                    
                    <div class="lg:col-span-1">
                        <label for="amountWonLoss" class="block text-sm font-medium text-gray-700 mb-1">Amount Won/Loss ($)</label>
                        <input type="number" 
                               id="amountWonLoss" 
                               step="0.01" 
                               placeholder="0.00" 
                               class="money-input w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500" 
                               required>
                    </div>
                </div>

                <div>
                    <label class="block text-lg font-semibold text-gray-700 mb-3">Individual Player/Team Bets</label>
                    <div id="playerPropInputs" class="space-y-3 mb-4">
                        </div>
                    <button type="button" 
                                id="addPlayerPropBtn" 
                                class="w-full bg-gray-200 text-gray-800 py-2 px-4 rounded-md shadow-sm hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-400 focus:ring-offset-2 transition duration-150 ease-in-out">
                        + Add Player/Team Bet
                    </button>
                </div>

                <div class="flex justify-end">
                    <button type="submit" 
                                id="submitBtn" 
                                class="bg-blue-600 text-white py-2 px-6 rounded-md shadow-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition duration-150 ease-in-out">
                        Add Parlay Entry
                    </button>
                </div>
            </form>
        </section>

        <section class="bg-blue-50 p-6 rounded-lg shadow-sm mb-8">
            <h2 class="text-2xl font-semibold text-blue-800 mb-4">Summary Statistics</h2>
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 text-blue-700 mb-6">
                <div class="bg-white p-4 rounded-lg">
                    <p class="text-sm text-blue-600 mb-1">Total Wagered</p>
                    <p class="text-2xl font-bold">$<span id="totalWagered">0.00</span></p>
                </div>
                
                <div class="bg-white p-4 rounded-lg">
                    <p class="text-sm text-blue-600 mb-1">Net Profit/Loss</p>
                    <p class="text-2xl font-bold">$<span id="netProfitLoss">0.00</span></p>
                </div>
                
                <div class="bg-white p-4 rounded-lg">
                    <p class="text-sm text-blue-600 mb-1">Total Parlays</p>
                    <p class="text-2xl font-bold"><span id="totalParlays">0</span></p>
                </div>
                
                <div class="bg-white p-4 rounded-lg">
                    <p class="text-sm text-green-600 mb-1">Wins</p>
                    <p class="text-xl font-bold text-green-700"><span id="totalWins">0</span></p>
                </div>
                
                <div class="bg-white p-4 rounded-lg">
                    <p class="text-sm text-red-600 mb-1">Losses</p>
                    <p class="text-xl font-bold text-red-700"><span id="totalLosses">0</span></p>
                </div>
                
                <div class="bg-white p-4 rounded-lg">
                    <p class="text-sm text-yellow-600 mb-1">Pushes</p>
                    <p class="text-xl font-bold text-yellow-700"><span id="totalPushes">0</span></p>
                </div>
            </div>

            <div class="bg-white p-4 rounded-lg mb-6">
                <label for="successPercentageCalc" class="block text-sm font-medium text-blue-700 mb-2">Success Rate</label>
                <div class="flex items-center space-x-3">
                    <select id="successPercentageCalc" 
                                class="px-3 py-2 border border-blue-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white text-blue-800">
                        <option value="parlays">Parlay Success Rate</option>
                        <option value="props">Individual Props Success Rate</option>
                    </select>
                    <p class="text-2xl font-bold text-blue-900"><span id="successPercentage">0.00</span>%</p>
                </div>
            </div>

            <div class="text-center">
                <button id="clearAllBtn" 
                                class="bg-red-500 text-white py-2 px-6 rounded-md shadow-md hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 transition duration-150 ease-in-out">
                    Clear All Entries
                </button>
            </div>
        </section>

        <section class="bg-white p-6 rounded-lg shadow-sm">
            <h2 class="text-2xl font-semibold text-gray-700 mb-4">Parlay History</h2>
            <div class="overflow-x-auto">
                <table class="min-w-full divide-y divide-gray-200">
                    <thead class="bg-gray-50">
                        <tr>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Date</th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Result</th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Type</th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Wagered</th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Won/Loss</th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Individual Bets</th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                        </tr>
                    </thead>
                    <tbody id="parlayTableBody" class="bg-white divide-y divide-gray-200">
                        </tbody>
                </table>
                <div id="noParlaysMessage" class="text-center text-gray-500 py-12 hidden">
                    <p class="text-lg">No parlays tracked yet.</p>
                    <p class="text-sm">Add your first parlay above to get started!</p>
                </div>
            </div>
        </section>
    </div>

    <div id="welcomeModal" class="modal-overlay hidden">
        <div class="modal-content">
            <h3 class="text-2xl font-bold text-gray-800 mb-4">Welcome to AYAW!</h3>
            <p class="text-gray-700 mb-6">
                This simple tracker helps you <strong>honestly monitor your parlay betting performance</strong> over time.
                Enter your parlay details, including individual prop outcomes, and see your overall profit/loss and success rate.
                All data is saved directly in your browser, so it's always there for you!
            </p>
            <div class="text-center">
                <button id="closeModalBtn" 
                                class="bg-blue-600 text-white py-2 px-6 rounded-md shadow-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition duration-150 ease-in-out">
                    Got It!
                </button>
            </div>
        </div>
    </div>

    <script>
        // Parlay Tracker Application
class ParlayTracker {
    constructor() {
        this.parlays = [];
        this.currentSuccessCalcMethod = 'parlays';
        this.editingIndex = -1;
        
        this.initializeElements();
        this.attachEventListeners();
        this.loadData();
        this.initializeUI();
    }

    // Initialize DOM element references
    initializeElements() {
        // Form elements
        this.parlayForm = document.getElementById('parlayForm');
        this.resultInput = document.getElementById('result');
        this.playTypeInput = document.getElementById('playType');
        this.amountWageredInput = document.getElementById('amountWagered');
        this.amountWonLossInput = document.getElementById('amountWonLoss');
        this.playerPropInputsContainer = document.getElementById('playerPropInputs');
        this.addPlayerPropBtn = document.getElementById('addPlayerPropBtn');
        this.submitBtn = document.getElementById('submitBtn');
        this.clearAllBtn = document.getElementById('clearAllBtn');

        // Table elements
        this.parlayTableBody = document.getElementById('parlayTableBody');
        this.noParlaysMessage = document.getElementById('noParlaysMessage');

        // Summary elements
        this.totalWageredSpan = document.getElementById('totalWagered');
        this.netProfitLossSpan = document.getElementById('netProfitLoss');
        this.totalWinsSpan = document.getElementById('totalWins');
        this.totalLossesSpan = document.getElementById('totalLosses');
        this.totalPushesSpan = document.getElementById('totalPushes');
        this.totalParlaysSpan = document.getElementById('totalParlays');
        this.successPercentageCalcSelect = document.getElementById('successPercentageCalc');
        this.successPercentageSpan = document.getElementById('successPercentage');

        // Modal elements
        this.welcomeModal = document.getElementById('welcomeModal');
        this.closeModalBtn = document.getElementById('closeModalBtn');
    }

    // Attach all event listeners
    attachEventListeners() {
        // Input focus handlers
        this.amountWageredInput.addEventListener('focus', this.handleInputFocus.bind(this));
        this.amountWonLossInput.addEventListener('focus', this.handleInputFocus.bind(this));

        // Money input handlers
        this.amountWageredInput.addEventListener('input', this.sanitizeMoneyInput.bind(this));
        this.amountWageredInput.addEventListener('blur', this.formatCurrencyOnBlur.bind(this));
        this.amountWonLossInput.addEventListener('input', this.sanitizeMoneyInput.bind(this));
        this.amountWonLossInput.addEventListener('blur', this.formatCurrencyOnBlur.bind(this));

        // Auto-calculation handlers
        this.resultInput.addEventListener('change', this.updateWonLossBasedOnResult.bind(this));
        this.amountWageredInput.addEventListener('input', this.updateWonLossBasedOnResult.bind(this));

        // Form and button handlers
        this.parlayForm.addEventListener('submit', this.handleFormSubmit.bind(this));
        this.addPlayerPropBtn.addEventListener('click', () => this.addPlayerPropRow());
        this.clearAllBtn.addEventListener('click', this.clearAllParlays.bind(this));
        this.successPercentageCalcSelect.addEventListener('change', this.handleSuccessCalcChange.bind(this));
        this.closeModalBtn.addEventListener('click', this.closeWelcomeModal.bind(this));
    }

    // Data persistence methods
    loadData() {
        const storedParlays = localStorage.getItem('parlays');
        if (storedParlays) {
            this.parlays = JSON.parse(storedParlays);
        }

        const storedCalcMethod = localStorage.getItem('successCalcMethod');
        if (storedCalcMethod) {
            this.currentSuccessCalcMethod = storedCalcMethod;
            this.successPercentageCalcSelect.value = storedCalcMethod;
        }
    }

    saveData() {
        localStorage.setItem('parlays', JSON.stringify(this.parlays));
        localStorage.setItem('successCalcMethod', this.currentSuccessCalcMethod);
    }

    // Input handling methods
    handleInputFocus(event) {
        if (event.target.value === '0.00') {
            event.target.select();
        }
    }

    sanitizeMoneyInput(event) {
        const input = event.target;
        const value = input.value;
        let cleanedValue = '';
        let hasDecimal = false;
        let hasNegative = false;

        for (let i = 0; i < value.length; i++) {
            const char = value[i];
            
            if (input.id === 'amountWonLoss' && char === '-' && i === 0 && !hasNegative) {
                cleanedValue += char;
                hasNegative = true;
            } else if (char === '.' && !hasDecimal) {
                cleanedValue += char;
                hasDecimal = true;
            } else if (/\d/.test(char)) {
                cleanedValue += char;
            }
        }

        input.value = cleanedValue;
    }

    formatCurrencyOnBlur(event) {
        const input = event.target;
        const value = input.value.trim();
        const numericValue = parseFloat(value.replace(/[^0-9.-]/g, ''));

        if (isNaN(numericValue) || numericValue === 0) {
            input.value = '0.00';
            return;
        }

        input.value = numericValue.toFixed(2);
    }

    updateWonLossBasedOnResult() {
        const parlayResult = this.resultInput.value;
        const wageredValue = parseFloat(this.amountWageredInput.value || '0');

        if (parlayResult === 'Win') {
            this.amountWonLossInput.value = ''; // Clear for manual entry on win
        } else if (parlayResult === 'Loss') {
            this.amountWonLossInput.value = (-wageredValue).toFixed(2);
        } else if (parlayResult === 'Push') {
            this.amountWonLossInput.value = '0.00';
        }
    }

    // Player prop management
    addPlayerPropRow(player = '', prop = '', result = 'Win') {
        const div = document.createElement('div');
        div.className = 'player-prop-row';

        div.innerHTML = `
            <div>
                <label class="block text-xs font-medium text-gray-600 mb-0.5">Player/Team</label>
                <input type="text" placeholder="e.g., Lakers" 
                        class="player-name mt-1 block w-full px-2 py-1.5 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-sm" 
                        value="${player}" required>
            </div>
            <div>
                <label class="block text-xs font-medium text-gray-600 mb-0.5">Prop Type</label>
                <input type="text" placeholder="e.g., Over 25.5 Pts" 
                        class="prop-type mt-1 block w-full px-2 py-1.5 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-sm" 
                        value="${prop}" required>
            </div>
            <div>
                <label class="block text-xs font-medium text-gray-600 mb-0.5">Prop Result</label>
                <select class="individual-result mt-1 block w-full px-2 py-1.5 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm">
                    <option value="Win"${result === 'Win' ? ' selected' : ''}>Win</option>
                    <option value="Loss"${result === 'Loss' ? ' selected' : ''}>Loss</option>
                    <option value="Push"${result === 'Push' ? ' selected' : ''}>Push</option>
                </select>
            </div>
            <button type="button" 
                    class="remove-prop-btn bg-red-100 text-red-700 p-2 rounded-md hover:bg-red-200 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 transition ease-in-out duration-150 self-end">
                Remove
            </button>
        `;

        this.playerPropInputsContainer.appendChild(div);

        // Add remove button event listener
        div.querySelector('.remove-prop-btn').addEventListener('click', () => {
            div.classList.add('removing'); // Add class for animation
            div.addEventListener('animationend', () => {
                div.remove();
                if (this.playerPropInputsContainer.children.length === 0) {
                    this.addPlayerPropRow(); // Add an empty row if all are removed
                }
            }, { once: true });
        });
    }

    // Form submission handler
    handleFormSubmit(event) {
        event.preventDefault();

        const bets = this.collectPlayerBets();
        if (!this.validatePlayerBets(bets)) {
            return;
        }

        const parlayData = this.createParlayData(bets);
        
        if (this.editingIndex !== -1) {
            this.updateParlay(parlayData);
        } else {
            this.addParlay(parlayData);
        }

        this.saveData();
        this.renderParlays();
        this.resetForm();
    }

    collectPlayerBets() {
        const playerBetRows = this.playerPropInputsContainer.querySelectorAll('.player-prop-row');
        const bets = [];

        Array.from(playerBetRows).forEach(row => {
            const playerNameInput = row.querySelector('.player-name');
            const propTypeInput = row.querySelector('.prop-type');
            const individualResultSelect = row.querySelector('.individual-result');

            if (playerNameInput.value.trim() && propTypeInput.value.trim()) {
                bets.push({
                    playerName: playerNameInput.value.trim(),
                    propType: propTypeInput.value.trim(),
                    individualResult: individualResultSelect.value
                });
            }
        });

        return bets;
    }

    validatePlayerBets(bets) {
        const playerBetRows = this.playerPropInputsContainer.querySelectorAll('.player-prop-row');
        let allValid = true;

        Array.from(playerBetRows).forEach(row => {
            const playerNameInput = row.querySelector('.player-name');
            const propTypeInput = row.querySelector('.prop-type');

            const isPlayerEmpty = !playerNameInput.value.trim();
            const isPropEmpty = !propTypeInput.value.trim();

            if (isPlayerEmpty || isPropEmpty) {
                allValid = false;
                playerNameInput.classList.add('border-red-500');
                propTypeInput.classList.add('border-red-500');
            } else {
                playerNameInput.classList.remove('border-red-500');
                propTypeInput.classList.remove('border-red-500');
            }
        });

        if (!allValid) {
            alert('Please fill in all Player/Team and Prop Type fields for individual bets.');
            return false;
        }

        if (bets.length === 0) {
            alert('Please add at least one individual player/team bet for the parlay.');
            return false;
        }

        return true;
    }

    createParlayData(bets) {
        return {
            date: this.editingIndex === -1 ? new Date().toISOString() : this.parlays[this.editingIndex].date,
            result: this.resultInput.value,
            playType: this.playTypeInput.value,
            amountWagered: parseFloat(this.amountWageredInput.value || '0'),
            amountWonLoss: parseFloat(this.amountWonLossInput.value || '0'),
            bets: bets
        };
    }

    addParlay(parlayData) {
        this.parlays.push(parlayData);
    }

    updateParlay(parlayData) {
        this.parlays[this.editingIndex] = parlayData;
        this.editingIndex = -1;
        this.submitBtn.textContent = 'Add Parlay Entry';
    }

    // Parlay management methods
    editParlay(index) {
        this.editingIndex = index;
        const parlayToEdit = this.parlays[index];

        // Populate form fields
        this.resultInput.value = parlayToEdit.result;
        this.playTypeInput.value = parlayToEdit.playType;
        this.amountWageredInput.value = parseFloat(parlayToEdit.amountWagered).toFixed(2);
        
        const wonLossValue = parseFloat(parlayToEdit.amountWonLoss);
        this.amountWonLossInput.value = wonLossValue > 0 
            ? `+${wonLossValue.toFixed(2)}` 
            : wonLossValue.toFixed(2);

        // Populate player props
        this.playerPropInputsContainer.innerHTML = '';
        if (parlayToEdit.bets && parlayToEdit.bets.length > 0) {
            parlayToEdit.bets.forEach(bet => {
                this.addPlayerPropRow(bet.playerName, bet.propType, bet.individualResult);
            });
        } else {
            this.addPlayerPropRow();
        }

        this.submitBtn.textContent = 'Update Parlay Entry';
        window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    deleteParlay(index) {
        if (!confirm('Are you sure you want to delete this parlay entry? This action cannot be undone.')) {
            return;
        }

        this.parlays.splice(index, 1);
        this.saveData();
        this.renderParlays();

        if (this.editingIndex === index) {
            this.resetForm();
        }
    }

    clearAllParlays() {
        if (!confirm('Are you sure you want to clear all parlay entries? This action cannot be undone.')) {
            return;
        }

        this.parlays = [];
        this.saveData();
        this.renderParlays();
        this.resetForm();
    }

    // UI rendering methods
    renderParlays() {
        this.parlayTableBody.innerHTML = '';
        
        if (this.parlays.length === 0) {
            this.noParlaysMessage.style.display = 'block';
        } else {
            this.noParlaysMessage.style.display = 'none';
            this.parlays.forEach((parlay, index) => this.renderParlayRow(parlay, index));
        }
        
        this.updateSummary();
    }

    renderParlayRow(parlay, index) {
        const row = this.parlayTableBody.insertRow();
        row.className = index % 2 === 0 ? 'bg-white' : 'bg-gray-50';

        // Date cell
        this.addCell(row, new Date(parlay.date).toLocaleDateString(), 'px-6 py-4 whitespace-nowrap text-sm text-gray-900');

        // Result cell
        const resultCell = this.addCell(row, parlay.result, 'px-6 py-4 whitespace-nowrap text-sm font-medium');
        this.applyResultStyling(resultCell, parlay.result);

        // Payout type cell
        this.addCell(row, parlay.playType, 'px-6 py-4 whitespace-nowrap text-sm text-gray-900');

        // Amount wagered cell
        this.addCell(row, parseFloat(parlay.amountWagered).toFixed(2), 'px-6 py-4 whitespace-nowrap text-sm text-gray-900');

        // Amount won/loss cell
        this.renderWonLossCell(row, parlay.amountWonLoss);

        // Individual bets cell
        this.renderBetsCell(row, parlay.bets);

        // Actions cell
        this.renderActionsCell(row, index);
    }

    addCell(row, content, className) {
        const cell = row.insertCell();
        cell.className = className;
        cell.textContent = content;
        return cell;
    }

    applyResultStyling(cell, result) {
        const colorMap = {
            'Win': 'text-green-600',
            'Loss': 'text-red-600',
            'Push': 'text-gray-600'
        };
        cell.classList.add(colorMap[result] || 'text-gray-600');
    }

    renderWonLossCell(row, amountWonLoss) {
        const cell = row.insertCell();
        cell.className = 'px-6 py-4 whitespace-nowrap text-sm';
        
        const value = parseFloat(amountWonLoss);
        if (value > 0) {
            cell.classList.add('text-green-600', 'font-medium');
            cell.textContent = `+${value.toFixed(2)}`;
        } else if (value < 0) {
            cell.classList.add('text-red-600', 'font-medium');
            cell.textContent = value.toFixed(2);
        } else {
            cell.classList.add('text-gray-600');
            cell.textContent = '0.00';
        }
    }

    renderBetsCell(row, bets) {
        const cell = row.insertCell();
        cell.className = 'px-6 py-4 text-sm text-gray-900';

        if (!bets || bets.length === 0) {
            cell.textContent = 'N/A';
            return;
        }

        const betsList = document.createElement('ul');
        betsList.className = 'list-disc list-inside text-xs';
        
        bets.forEach(bet => {
            const listItem = document.createElement('li');
            const resultColorMap = {
                'Win': 'text-green-600',
                'Loss': 'text-red-600',
                'Push': 'text-gray-800'
            };
            const resultColor = resultColorMap[bet.individualResult] || 'text-gray-800';
            
            listItem.innerHTML = `<span class="font-medium">${bet.playerName}</span>: ${bet.propType} (<span class="${resultColor}">${bet.individualResult}</span>)`;
            betsList.appendChild(listItem);
        });
        
        cell.appendChild(betsList);
    }

    renderActionsCell(row, index) {
        const actionsCell = row.insertCell();
        actionsCell.className = 'px-6 py-4 whitespace-nowrap text-left text-sm font-medium flex flex-col space-y-1 items-start';

        const editBtn = this.createActionButton('Edit', 'text-blue-600 hover:text-blue-800 px-2 py-1 rounded-md border border-blue-200', () => this.editParlay(index));
        const deleteBtn = this.createActionButton('Delete', 'text-red-500 hover:text-red-700 px-2 py-1 rounded-md border border-red-200', () => this.deleteParlay(index));
        
        actionsCell.appendChild(editBtn);
        actionsCell.appendChild(deleteBtn);
    }

    createActionButton(text, className, onClickHandler) {
        const button = document.createElement('button');
        button.type = 'button';
        button.textContent = text;
        button.className = className + ' transition duration-150 ease-in-out';
        button.addEventListener('click', onClickHandler);
        return button;
    }

    // Summary calculation and display
    updateSummary() {
        let totalWagered = 0;
        let netProfitLoss = 0;
        let totalWins = 0;
        let totalLosses = 0;
        let totalPushes = 0;
        let totalIndividualProps = 0;
        let individualPropWins = 0;

        this.parlays.forEach(parlay => {
            totalWagered += parlay.amountWagered;
            netProfitLoss += parlay.amountWonLoss;

            if (parlay.result === 'Win') {
                totalWins++;
            } else if (parlay.result === 'Loss') {
                totalLosses++;
            } else if (parlay.result === 'Push') {
                totalPushes++;
            }

            if (parlay.bets) {
                parlay.bets.forEach(bet => {
                    totalIndividualProps++;
                    if (bet.individualResult === 'Win') {
                        individualPropWins++;
                    }
                });
            }
        });

        this.totalWageredSpan.textContent = totalWagered.toFixed(2);
        this.netProfitLossSpan.textContent = netProfitLoss.toFixed(2);
        
        // Apply color to net profit/loss
        if (netProfitLoss > 0) {
            this.netProfitLossSpan.classList.remove('text-red-700', 'text-yellow-700');
            this.netProfitLossSpan.classList.add('text-green-700');
        } else if (netProfitLoss < 0) {
            this.netProfitLossSpan.classList.remove('text-green-700', 'text-yellow-700');
            this.netProfitLossSpan.classList.add('text-red-700');
        } else {
            this.netProfitLossSpan.classList.remove('text-green-700', 'text-red-700');
            this.netProfitLossSpan.classList.add('text-gray-700');
        }

        this.totalWinsSpan.textContent = totalWins;
        this.totalLossesSpan.textContent = totalLosses;
        this.totalPushesSpan.textContent = totalPushes;
        this.totalParlaysSpan.textContent = this.parlays.length;

        this.calculateSuccessPercentage(totalWins, this.parlays.length, individualPropWins, totalIndividualProps);
    }

    calculateSuccessPercentage(totalWins, totalParlays, individualPropWins, totalIndividualProps) {
        let percentage = 0;
        if (this.currentSuccessCalcMethod === 'parlays' && totalParlays > 0) {
            percentage = (totalWins / totalParlays) * 100;
        } else if (this.currentSuccessCalcMethod === 'props' && totalIndividualProps > 0) {
            percentage = (individualPropWins / totalIndividualProps) * 100;
        }
        this.successPercentageSpan.textContent = percentage.toFixed(2);
    }

    handleSuccessCalcChange(event) {
        this.currentSuccessCalcMethod = event.target.value;
        this.saveData(); // Save the user's preference
        this.updateSummary();
    }

    // Form reset
    resetForm() {
        this.parlayForm.reset();
        this.playerPropInputsContainer.innerHTML = '';
        this.addPlayerPropRow(); // Add one empty row for new input
        this.submitBtn.textContent = 'Add Parlay Entry';
        this.editingIndex = -1;
        this.amountWageredInput.value = '0.00';
        this.amountWonLossInput.value = '0.00';
    }

    // Modal display logic
    initializeUI() {
        // Show welcome modal only if no parlays are stored and it hasn't been shown before
        const hasShownWelcome = localStorage.getItem('hasShownWelcome');
        if (this.parlays.length === 0 && !hasShownWelcome) {
            this.showWelcomeModal();
        }
        this.renderParlays(); // Render parlays on load
        this.addPlayerPropRow(); // Add initial player prop row
    }

    showWelcomeModal() {
        this.welcomeModal.classList.add('show');
    }

    closeWelcomeModal() {
        this.welcomeModal.classList.remove('show');
        localStorage.setItem('hasShownWelcome', 'true'); // Mark as shown
    }
}

// Instantiate the tracker when the DOM is fully loaded
document.addEventListener('DOMContentLoaded', () => {
    new ParlayTracker();
});

    </script>
</body>
</html>
